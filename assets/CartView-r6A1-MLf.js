import{c as T}from"./cart-Poho2KGd.js";import{M as L,T as P}from"./bootstrap.esm-l9cKv-78.js";import{_ as A,R as I,m as N,c as d,b as t,d as r,w as u,F as h,j as b,g as p,t as a,e as k,r as C,o as n}from"./index-ZYguVHt9.js";import{a as m}from"./axios-G2rPRu76.js";import{L as E}from"./index-sbQ5JdVd.js";import"./commonjsHelpers-1J56E-h6.js";var V={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_API_NAME:"ssozr",BASE_URL:"/vue2024week62/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:y,VITE_APP_API_NAME:f}=V,R={data(){return{cartToast:!1,cartData:[],dalModal:"",delData:{},delId:"",disabled:!1,productData:{},isLoading:!1,myToast:{title:""},modal:{Title:"",btn:""}}},components:{RouterLink:I,Loading:E},methods:{getCartData(){m.get(`${y}/v2/api/${f}/cart`).then(e=>{this.cartData=e.data.data,console.log(this.cartData)}).catch(e=>{alert(e.data.message).error(e)}).finally(()=>{this.isLoading=!1})},openDelModal(e){this.deldata={},this.delModal.show(),this.delId=e.id,this.delData=e.product,this.delData.title=`刪除課程:${e.product.title}`},openDelAllModal(){this.delData={},this.delId="",this.delData.title="確定要清空購物車?",this.delModal.show()},delCart(){this.delId?m.delete(`${y}/v2/api/${f}/cart/${this.delId}`).then(e=>{e.data.success===!0&&(this.myToast.title="已刪除課程",this.myToast.show()),this.delData={},this.delId="",this.delModal.hide(),this.getCartData(),this.getCartDataPinia()}).catch(e=>{alert(e.data.message).error(e)}):m.delete(`${y}/v2/api/${f}/carts`).then(e=>{e.data.success===!0&&(this.myToast.title="已清空購物車",this.myToast.show()),this.delData={},this.delId=" ",this.delModal.hide(),this.getCartData(),this.getCartDataPinia()}).catch(e=>{alert(e.data.message).error(e)})},changeQty(e,i,D){this.disabled=!0;const w={product_id:D,qty:e};m.put(`${y}/v2/api/${f}/cart/${i}`,{data:w}).then(()=>{this.myToast.title="已更新數量",this.myToast.show(),this.disabled=!1,this.getCartData()}).catch(o=>{alert(o.data.message).error(o)})},formatNumber(e){if(e)return e.toLocaleString()},...N(T,["getCartDataPinia"])},mounted(){this.isLoading=!0,this.getCartData(),this.delModal=new L(this.$refs.delModal),this.myToast=new P(this.$refs.myToast)}},B={class:"container mt-15 mt-md-30","data-aos":"fade-right"},j={class:"row justify-content-center"},S={key:0,class:"text-center my-30"},q=t("div",{class:"d-flex justify-content-center"},[t("h2",{class:"mb-10 border-bottom border-3 border-primary"}," 尚未收錄課程 ")],-1),O={key:1,class:"table-wrapper d-lg-block d-none"},U={class:"table align-middle"},Q={class:"text-center"},z=t("th",null,"課程名稱",-1),F=t("th",null,"授課老師",-1),$=t("th",null,"總課程數",-1),G=t("th",null,"購買數量",-1),H=t("th",null,"單價",-1),J=t("th",null,"價格",-1),K={class:"fs-5"},W={class:"dropdown"},X=["disabled"],Y={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},Z=["onClick"],tt=["onClick"],st=t("span",{class:"material-symbols-outlined d-flex text-black"}," close ",-1),et=[st],ot={class:"text-center"},at=t("td",null,null,-1),lt=t("td",null,null,-1),dt=t("td",null,null,-1),nt=t("td",null,null,-1),it=t("td",null,null,-1),ct={class:"align-bottom"},rt={class:"border-bottom border-secondary border-3 mb-0 fs-6"},_t={class:"ms-1"},ut=t("button",{type:"button",class:"btn btn-primary"}," 結帳 ",-1),ht={key:2,class:"row d-lg-none my-15"},bt={class:"d-flex justify-content-end"},pt={class:"d-flex justify-content-between align-items-center"},mt={class:"fs-6 fw-bold"},yt=["onClick"],ft=t("span",{class:"material-symbols-outlined"}," close ",-1),gt=[ft],vt={class:"mb-3"},Dt={class:"d-flex align-items-center justify-content-between mb-3"},wt={class:"dropdown d-flex"},kt=["disabled"],Ct={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton2"},xt=["onClick"],Mt={class:"d-flex justify-content-between"},Tt={class:"border-bottom border-secondary border-3 mb-0 fs-4"},Lt={class:"ms-1"},Pt=t("button",{type:"button",class:"btn btn-primary"}," 結帳 ",-1),At={class:"modal",tabindex:"-1",ref:"delModal"},It={class:"modal-dialog"},Nt={class:"modal-content"},Et={class:"modal-header"},Vt={key:0,class:"modal-title"},Rt=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Bt={class:"modal-footer"},jt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1),St={class:"position-fixed bottom-0 end-0 p-3",style:{"z-index":"5"}},qt={id:"liveToast",class:"toast hide",ref:"myToast",role:"alert","aria-live":"assertive","aria-atomic":"true"},Ot={class:"toast-header bg-secondary"},Ut={class:"me-auto text-white"},Qt=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"toast","aria-label":"Close"},null,-1);function zt(e,i,D,w,o,l){const x=C("Loading"),_=C("RouterLink");return n(),d(h,null,[t("div",B,[t("div",j,[r(x,{active:o.isLoading,"onUpdate:active":i[0]||(i[0]=s=>o.isLoading=s)},null,8,["active"]),o.cartData.total===0?(n(),d("div",S,[q,r(_,{to:"products",class:"btn btn-primary"},{default:u(()=>[p("立即前往課程列表")]),_:1})])):(n(),d("div",O,[t("table",U,[t("thead",null,[t("tr",Q,[z,F,$,G,H,J,t("th",null,[t("button",{type:"button",class:"btn btn-outline-light rounded-pill",onClick:i[1]||(i[1]=s=>l.openDelAllModal())}," 清空購物車 ")])])]),t("tbody",null,[(n(!0),d(h,null,b(o.cartData.carts,(s,g)=>(n(),d("tr",{key:g,class:"text-center"},[t("td",null,[r(_,{to:`/product/${s.product.id}`},{default:u(()=>[t("h2",K,a(s.product.title),1)]),_:2},1032,["to"])]),t("td",null,a(s.product.unit),1),t("td",null,a(s.product.origin_price*s.qty)+"堂",1),t("td",null,[t("div",W,[t("button",{disabled:o.disabled,class:"btn btn-outline-light dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"},a(s.qty),9,X),t("ul",Y,[(n(),d(h,null,b(20,(c,v)=>t("li",{key:v},[t("a",{onClick:M=>l.changeQty(c,s.id,s.product_id),class:"dropdown-item"},a(c),9,Z)])),64))])])]),t("td",null,a(s.product.price),1),t("td",null,a(l.formatNumber(s.total)),1),t("td",null,[t("button",{type:"button",class:"btn rounded-pill",onClick:c=>l.openDelModal(s)},et,8,tt)])]))),128)),t("tr",ot,[at,lt,dt,nt,it,t("td",ct,[t("h2",rt,[p(" 總金額:NT "),t("span",_t,a(l.formatNumber(o.cartData.total)),1)])]),t("td",null,[r(_,{to:"/Order"},{default:u(()=>[ut]),_:1})])])])])])),o.cartData.total!==0?(n(),d("div",ht,[t("div",bt,[t("button",{type:"button",class:"btn btn-outline-light rounded-pill col-4 mb-3",onClick:i[2]||(i[2]=s=>l.openDelAllModal())}," 清空購物車 ")]),(n(!0),d(h,null,b(o.cartData.carts,(s,g)=>(n(),d("ul",{key:g,class:"border-bottom pb-3 border-primary"},[t("li",null,[t("div",pt,[r(_,{to:`/product/${s.product.id}`},{default:u(()=>[t("h2",mt,a(s.product.title),1)]),_:2},1032,["to"]),t("button",{type:"button",class:"btn text-black rounded-pill",onClick:c=>l.openDelModal(s)},gt,8,yt)]),t("p",vt,"單價:"+a(s.product.price),1),t("div",Dt,[t("div",null,"總數:"+a(s.product.origin_price*s.qty)+"堂",1),t("div",wt,[p(" 次數: "),t("button",{disabled:o.disabled,class:"btn btn-outline-light dropdown-toggle py-0 ms-3",type:"button",id:"dropdownMenuButton2","data-bs-toggle":"dropdown","aria-expanded":"false"},a(s.qty),9,kt),t("ul",Ct,[(n(),d(h,null,b(20,(c,v)=>t("li",{key:v},[t("a",{onClick:M=>l.changeQty(c,s.id,s.product_id),class:"dropdown-item"},a(c),9,xt)])),64))])])]),t("div",null,"總額: $"+a(l.formatNumber(s.total)),1)])]))),128)),t("div",Mt,[t("h2",Tt,[p(" 總金額:NT "),t("span",Lt,a(l.formatNumber(o.cartData.total)),1)]),r(_,{to:"/Order"},{default:u(()=>[Pt]),_:1})])])):k("",!0)])]),t("div",At,[t("div",It,[t("div",Nt,[t("div",Et,[o.delData.title?(n(),d("h5",Vt,a(o.delData.title),1)):k("",!0),Rt]),t("div",Bt,[jt,t("button",{type:"button",class:"btn btn-secondary",onClick:i[3]||(i[3]=s=>l.delCart(o.delData.id))}," 確認 ")])])])],512),t("div",St,[t("div",qt,[t("div",Ot,[t("strong",Ut,a(o.myToast.title),1),Qt])],512)])],64)}const Wt=A(R,[["render",zt]]);export{Wt as default};
