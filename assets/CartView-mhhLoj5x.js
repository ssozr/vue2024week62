import{c as x}from"./cart-fTV6V2g5.js";import{M as P}from"./bootstrap.esm-TTjMTX3M.js";import{_ as I,R as A,m as N,c as d,b as t,d as u,w as h,F as b,i as p,g as m,t as o,e as k,r as E,o as l}from"./index-8k5VWNwC.js";import{S as C}from"./sweetalert2.all-t36qbmOe.js";import{a as y}from"./axios-G2rPRu76.js";var V={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_API_NAME:"ssozr",BASE_URL:"/vue2024week62/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:f,VITE_APP_API_NAME:g}=V,R={data(){return{cartData:[],dalModal:"",delData:{},delId:"",disabled:!1,productData:{}}},components:{RouterLink:A},methods:{getCartData(){y.get(`${f}/v2/api/${g}/cart`).then(e=>{this.cartData=e.data.data}).catch(e=>{alert(e.data.message).error(e)})},openDelModal(e){this.deldata={},this.delModal.show(),this.delId=e.id,this.delData=e.product},openDelAllModal(){this.delData={},this.delId="",this.delData.title="全部商品",this.delModal.show()},delCart(){this.delId?y.delete(`${f}/v2/api/${g}/cart/${this.delId}`).then(e=>{this.delData={},this.delId="",this.delModal.hide(),this.getCartData(),C.fire(`${e.data.message}`),this.getCartDataPinia()}).catch(e=>{alert(e.data.message).error(e)}):y.delete(`${f}/v2/api/${g}/carts`).then(()=>{this.delData={},this.delId=" ",this.delModal.hide(),this.getCartData(),this.getCartDataPinia()}).catch(e=>{alert(e.data.message).error(e)})},changeQty(e,r){this.disabled=!0;const w={product_id:r,qty:e};y.put(`${f}/v2/api/${g}/cart/${r}`,{data:w}).then(c=>{C.fire(`${c.data.message}`),this.disabled=!1,this.getCartData()}).catch(c=>{alert(c.data.message).error(c)})},formatNumber(e){if(e)return e.toLocaleString()},...N(x,["getCartDataPinia"])},mounted(){this.getCartData(),this.delModal=new P(this.$refs.delModal)}},B={class:"container","data-aos":"fade-right"},L={class:"row justify-content-center"},S={key:0,class:"text-center my-30"},T=t("div",{class:"d-flex justify-content-center"},[t("h2",{class:"mb-10 border-bottom border-3 border-primary"},"尚未收錄課程")],-1),j={key:1,class:"table-wrapper d-lg-block d-none"},q={class:"table align-middle"},$={class:"text-center"},O=t("th",null,"課程名稱",-1),Q=t("th",null,"授課老師",-1),U=t("th",null,"總課程數",-1),F=t("th",null,"購買數量",-1),z=t("th",null,"價格",-1),G={class:"fs-5"},H={class:"dropdown"},J=["disabled"],K={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},W=["onClick"],X=["onClick"],Y={class:"text-center"},Z=t("td",null,null,-1),tt=t("td",null,null,-1),et=t("td",null,null,-1),st=t("td",null,null,-1),ot={class:"align-bottom"},at={class:"border-bottom border-primary border-3 mb-0 fs-6"},dt={class:"ms-1"},lt=t("button",{type:"button",class:"btn btn-primary"},"結帳",-1),nt={key:2,class:"row d-lg-none my-15"},rt={class:""},it={class:"d-flex justify-content-between align-items-center mb-3"},ct={class:"fs-5"},_t=["onClick"],ut={class:"d-flex align-items-center justify-content-between"},ht={class:"dropdown"},bt=["disabled"],pt={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},mt=["onClick"],yt={class:"d-flex justify-content-between"},ft={class:"border-bottom border-primary border-3 mb-0 fs-4"},gt={class:"ms-1"},vt=t("button",{type:"button",class:"btn btn-primary"},"結帳",-1),Dt=t("div",null,null,-1),wt={class:"modal",tabindex:"-1",ref:"delModal"},kt={class:"modal-dialog"},Ct={class:"modal-content"},Mt={class:"modal-header"},xt={key:0,class:"modal-title"},Pt=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),It=t("div",{class:"modal-body"},[t("p",null,"確定移出此課程?")],-1),At={class:"modal-footer"},Nt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function Et(e,r,w,c,a,n){const _=E("RouterLink");return l(),d(b,null,[t("div",B,[t("div",L,[a.cartData.total===0?(l(),d("div",S,[T,u(_,{to:"products",class:"btn btn-primary"},{default:h(()=>[m("立即前往課程列表")]),_:1})])):(l(),d("div",j,[t("table",q,[t("thead",null,[t("tr",$,[O,Q,U,F,z,t("th",null,[t("button",{type:"button",class:"btn btn-primary rounded-pill",onClick:r[0]||(r[0]=s=>n.openDelAllModal())},"清空購物車")])])]),t("tbody",null,[(l(!0),d(b,null,p(a.cartData.carts,(s,v)=>(l(),d("tr",{key:v,class:"text-center"},[t("td",null,[u(_,{to:`/class/${s.product.id}`},{default:h(()=>[t("h2",G,o(s.product.title),1)]),_:2},1032,["to"])]),t("td",null,o(s.product.unit),1),t("td",null,o(s.product.origin_price*s.qty)+"堂",1),t("td",null,[t("div",H,[t("button",{disabled:a.disabled,class:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"},o(s.qty),9,J),t("ul",K,[(l(),d(b,null,p(20,(i,D)=>t("li",{key:D},[t("a",{onClick:M=>n.changeQty(i,s.id),class:"dropdown-item"},o(i),9,W)])),64))])])]),t("td",null,o(n.formatNumber(s.total)),1),t("td",null,[t("button",{type:"button",class:"btn btn-primary rounded-pill",onClick:i=>n.openDelModal(s)},"刪除",8,X)])]))),128)),t("tr",Y,[Z,tt,et,st,t("td",ot,[t("h2",at,[m("總金額:NT "),t("span",dt,o(n.formatNumber(a.cartData.total)),1)])]),t("td",null,[u(_,{to:"/Order"},{default:h(()=>[lt]),_:1})])])])])])),a.cartData.total!==0?(l(),d("div",nt,[(l(!0),d(b,null,p(a.cartData.carts,(s,v)=>(l(),d("ul",{key:v,class:"border-bottom pb-3 border-primary"},[t("li",rt,[t("div",it,[u(_,{to:`/class/${s.product.id}`},{default:h(()=>[t("h2",ct,o(s.product.title),1)]),_:2},1032,["to"]),t("button",{type:"button",class:"btn btn-primary rounded-pill",onClick:i=>n.openDelModal(s)},"刪除",8,_t)]),t("div",ut,[t("div",null,"總堂數:"+o(s.product.origin_price*s.qty)+"堂",1),t("div",ht,[m(" 購買次數: "),t("button",{disabled:a.disabled,class:"btn btn-secondary dropdown-toggle py-0",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"},o(s.qty),9,bt),t("ul",pt,[(l(),d(b,null,p(20,(i,D)=>t("li",{key:D},[t("a",{onClick:M=>n.changeQty(i,s.id),class:"dropdown-item"},o(i),9,mt)])),64))])]),t("div",null,"此課程總額: $"+o(n.formatNumber(s.total)),1)])])]))),128)),t("div",yt,[t("h2",ft,[m(" 總金額:NT "),t("span",gt,o(n.formatNumber(a.cartData.total)),1)]),u(_,{to:"/Order"},{default:h(()=>[vt]),_:1})])])):k("",!0),Dt])]),t("div",wt,[t("div",kt,[t("div",Ct,[t("div",Mt,[a.delData.title?(l(),d("h5",xt,o(a.delData.title),1)):k("",!0),Pt]),It,t("div",At,[Nt,t("button",{type:"button",class:"btn btn-primary",onClick:r[1]||(r[1]=s=>n.delCart(a.delData.id))},"確認移出")])])])],512)],64)}const Tt=I(R,[["render",Et]]);export{Tt as default};
