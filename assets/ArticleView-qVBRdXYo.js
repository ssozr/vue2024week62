import{S as u,L as k,P as M,M as x}from"./bootstrap.esm-jMk4ECTY.js";import{a as r}from"./axios-G2rPRu76.js";import{_ as A,c as d,b as t,F as b,g as L,h as l,v as c,t as _,i as V,a as w,e as C,f as U,r as g,o as i}from"./index-6aoXa4Ci.js";var E={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_API_NAME:"ssozr",BASE_URL:"/vue2024week62/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:h,VITE_APP_API_NAME:m}=E,I={data(){return{isLoading:!1,date:"",modal:!0,ariticleData:{},articleModal:"",pagination:{},dataId:"",data:{title:"",description:"",image:"",tag:"",create_at:"",author:"",isPublic:!1,content:""}}},methods:{getAriticle(){r.get(`${h}/v2/api/${m}/admin/articles`).then(a=>{this.ariticleData=a.data,this.isLoading=!1,this.pagination=a.data.pagination}).catch(a=>{alert(a.data.message).error(a)})},openEditModla(a){console.log(a),this.isLoading=!0,r.get(`${h}/v2/api/${m}/admin/article/${a.id}`).then(e=>{console.log(e.data.article),this.isLoading=!1,this.data={...e.data.article},this.articleModal.show()}).catch(e=>{alert(e.data.message).error(e)}),this.modal=!1,this.date=a.create_at,this.data.create_at=this.time(a.create_at),this.dataId=a.id},openModal(){this.modal=!0,this.data={title:"",description:"",image:"",tag:"",create_at:"",author:"",isPublic:!1,content:""},this.articleModal.show()},newArticle(){if(this.modal===!0){this.timeChange();const a={...this.data};r.post(`${h}/v2/api/${m}/admin/article`,{data:a}).then(e=>{this.data={},u.fire(`${e.data.message}`),this.getAriticle(),this.articleModal.hide()}).catch(e=>{alert(e.data.message).error(e)})}else{this.timeChange();const a={...this.data};console.log(a),r.put(`${h}/v2/api/${m}/admin/article/${this.dataId}`,{data:a}).then(e=>{this.data={},this.getAriticle(),u.fire(`${e.data.message}`),this.articleModal.hide()}).catch(e=>{alert(e.data.message).error(e)})}},timeChange(){const a=new Date(this.data.create_at);a.setHours(0,0,0,0);const e=a.getTime()/1e3;this.data.create_at=e,console.log(this.data.create_at)},time(a){const e=new Date(a*1e3),p={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"};return e.toLocaleString("zh-TW",p)},delArticle(a){r.delete(`${h}/v2/api/${m}/admin/article/${a}`).then(e=>{this.getAriticle(),u.fire(`${e.data.message}`)}).catch(e=>{alert(e.data.message).error(e)})},changePage(a){this.getProducts(a)}},components:{Loading:k,Pagination:M},mounted(){this.isLoading=!0,this.getAriticle(),this.articleModal=new x(this.$refs.articleModal)}},D={class:"container"},S={class:"text-end mt-4"},T={class:"table mt-4"},B=t("thead",null,[t("tr",null,[t("th",null,"文章名稱"),t("th",null," 日期 "),t("th",null," 作者 "),t("th",null," 是否啟用 "),t("th",null," 編輯 ")])],-1),N={key:0,class:"text-success"},R={key:1},z={class:"btn-group"},F=["onClick"],O=["onClick"],H={id:"productModal",ref:"articleModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},W={class:"modal-dialog modal-xl"},j={class:"modal-content border-0"},q=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{id:"productModalLabel",class:"modal-title"},[t("span",null,"新增產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),G={class:"modal-body"},J={class:"row"},K={class:"col-sm-4"},Q={class:"mb-2"},X={class:"mb-3"},Y=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),Z=t("img",{class:"img-fluid",src:"",alt:"要新增的圖片"},null,-1),$=t("div",null,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100"}," 新增圖片 ")],-1),tt={class:"col-sm-8"},et={class:"mb-3"},at=t("label",{for:"title",class:"form-label"},"標題",-1),st={class:"row"},ot={class:"mb-3 col-md-6"},lt=t("label",{for:"category",class:"form-label"},"作者",-1),it={class:"row"},nt={class:"mb-3 col-md-6"},dt=t("label",{for:"origin_price",class:"form-label"},"標籤",-1),ct={class:"mb-3 col-md-6"},rt={key:0,for:"date",class:"form-label"},ht={key:1,for:"date"},mt=t("hr",null,null,-1),_t={class:"mb-3"},ut=t("label",{for:"description",class:"form-label"},"文章描述",-1),pt={class:"mb-3"},bt=t("label",{for:"content",class:"form-label"},"這是內容",-1),gt={class:"mb-3"},ft={class:"form-check"},vt=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),yt={class:"modal-footer"},Pt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function kt(a,e,p,Mt,o,n){const f=g("Loading"),v=g("Pagination");return i(),d(b,null,[t("div",D,[t("div",S,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=s=>n.openModal())}," 建立新的文章 ")]),t("table",T,[B,t("tbody",null,[(i(!0),d(b,null,L(o.ariticleData.articles,(s,y)=>(i(),d("tr",{key:y},[t("td",null,_(s.title),1),t("td",null,_(n.time(s.create_at)),1),t("td",null,_(s.author),1),t("td",null,[s.isPublic?(i(),d("span",N,"啟用")):(i(),d("span",R,"未啟用"))]),t("td",null,[t("div",z,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:P=>n.openEditModla(s)}," 編輯 ",8,F),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:P=>n.delArticle(s.id)}," 刪除 ",8,O)])])]))),128))])])]),t("div",H,[t("div",W,[t("div",j,[q,t("div",G,[t("div",J,[t("div",K,[t("div",Q,[t("div",X,[Y,l(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[1]||(e[1]=s=>o.data.image=s)},null,512),[[c,o.data.image]])]),Z]),$]),t("div",tt,[t("div",et,[at,l(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[2]||(e[2]=s=>o.data.title=s)},null,512),[[c,o.data.title]])]),t("div",st,[t("div",ot,[lt,l(t("input",{id:"category",type:"text",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=s=>o.data.author=s),placeholder:"請輸入作者"},null,512),[[c,o.data.author]])])]),t("div",it,[t("div",nt,[dt,l(t("input",{id:"origin_price",type:"text",min:"0",class:"form-control",placeholder:"請輸入標籤","onUpdate:modelValue":e[4]||(e[4]=s=>o.data.tag=s)},null,512),[[c,o.data.tag]])]),t("div",ct,[o.date?(i(),d("label",ht,"發布日期:"+_(n.time(o.date)),1)):(i(),d("label",rt,"日期")),l(t("input",{id:"date",type:"date",min:"0",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=s=>o.data.create_at=s),placeholder:"請輸入日期"},null,512),[[c,o.data.create_at]])])]),mt,t("div",_t,[ut,l(t("textarea",{id:"description",type:"text",class:"form-control","onUpdate:modelValue":e[6]||(e[6]=s=>o.data.description=s),placeholder:"請輸入產品 描述"},`\r
                      `,512),[[c,o.data.description]])]),t("div",pt,[bt,l(t("textarea",{id:"description",type:"text",class:"form-control","onUpdate:modelValue":e[7]||(e[7]=s=>o.data.content=s),placeholder:"請輸入說明內容"},`\r
                      `,512),[[c,o.data.content]])]),t("div",gt,[t("div",ft,[l(t("input",{type:"checkbox",class:"form-check-input",id:"is_enabled","onUpdate:modelValue":e[8]||(e[8]=s=>o.data.isPublic=s)},null,512),[[V,o.data.isPublic]]),vt])])])])]),t("div",yt,[Pt,t("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=s=>n.newArticle())}," 確認 ")])])])],512),w(f,{active:o.isLoading,"onUpdate:active":e[10]||(e[10]=s=>o.isLoading=s)},null,8,["active"]),o.pagination.total_pages>=2?(i(),C(v,{key:0,pagination:o.pagination,onChangePage:n.changePage},null,8,["pagination","onChangePage"])):U("",!0)],64)}const Vt=A(I,[["render",kt]]);export{Vt as default};
