import{L as k}from"./index-jpRsFhqA.js";import{S as u}from"./sweetalert2.all-t36qbmOe.js";import{P as M}from"./PaginationView-BdTuNAr-.js";import{M as x}from"./bootstrap.esm-TTjMTX3M.js";import{a as r}from"./axios-G2rPRu76.js";import{_ as A,c as d,b as t,F as b,i as L,z as l,D as c,t as _,E as V,d as w,h as C,e as E,r as g,o as i}from"./index-hh5bvLeO.js";var U={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_API_NAME:"ssozr",BASE_URL:"/vue2024week62/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:m,VITE_APP_API_NAME:h}=U,D={data(){return{isLoading:!1,date:"",modal:!0,ariticleData:{},articleModal:"",pagination:{},dataId:"",data:{title:"",description:"",image:"",tag:"",create_at:"",author:"",isPublic:!1,content:""}}},methods:{getAriticle(){r.get(`${m}/v2/api/${h}/admin/articles`).then(a=>{this.ariticleData=a.data,this.isLoading=!1,this.pagination=a.data.pagination}).catch(a=>{alert(a.data.message).error(a)})},openEditModla(a){console.log(a),this.isLoading=!0,r.get(`${m}/v2/api/${h}/admin/article/${a.id}`).then(e=>{console.log(e.data.article),this.isLoading=!1,this.data={...e.data.article},this.articleModal.show()}).catch(e=>{alert(e.data.message).error(e)}),this.modal=!1,this.date=a.create_at,this.data.create_at=this.time(a.create_at),this.dataId=a.id},openModal(){this.modal=!0,this.data={title:"",description:"",image:"",tag:"",create_at:"",author:"",isPublic:!1,content:""},this.articleModal.show()},newArticle(){if(this.modal===!0){this.timeChange();const a={...this.data};r.post(`${m}/v2/api/${h}/admin/article`,{data:a}).then(e=>{this.data={},u.fire(`${e.data.message}`),this.getAriticle(),this.articleModal.hide()}).catch(e=>{alert(e.data.message).error(e)})}else{this.timeChange();const a={...this.data};console.log(a),r.put(`${m}/v2/api/${h}/admin/article/${this.dataId}`,{data:a}).then(e=>{this.data={},this.getAriticle(),u.fire(`${e.data.message}`),this.articleModal.hide()}).catch(e=>{alert(e.data.message).error(e)})}},timeChange(){const a=new Date(this.data.create_at);a.setHours(0,0,0,0);const e=a.getTime()/1e3;this.data.create_at=e,console.log(this.data.create_at)},time(a){const e=new Date(a*1e3),p={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"};return e.toLocaleString("zh-TW",p)},delArticle(a){r.delete(`${m}/v2/api/${h}/admin/article/${a}`).then(e=>{this.getAriticle(),u.fire(`${e.data.message}`)}).catch(e=>{alert(e.data.message).error(e)})},changePage(a){this.getProducts(a)}},components:{Loading:k,Pagination:M},mounted(){this.isLoading=!0,this.getAriticle(),this.articleModal=new x(this.$refs.articleModal)}},I={class:"container"},S={class:"text-end mt-4"},T={class:"table mt-4"},B=t("thead",null,[t("tr",null,[t("th",null,"文章名稱"),t("th",null," 日期 "),t("th",null," 作者 "),t("th",null," 是否啟用 "),t("th",null," 編輯 ")])],-1),N={key:0,class:"text-success"},R={key:1},z={class:"btn-group"},F=["onClick"],O=["onClick"],H={id:"productModal",ref:"articleModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},W={class:"modal-dialog modal-xl"},j={class:"modal-content border-0"},q=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{id:"productModalLabel",class:"modal-title"},[t("span",null,"新增產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),G={class:"modal-body"},J={class:"row"},K={class:"col-sm-4"},Q={class:"mb-2"},X={class:"mb-3"},Y=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),Z=t("img",{class:"img-fluid",src:"",alt:"要新增的圖片"},null,-1),$=t("div",null,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100"}," 新增圖片 ")],-1),tt={class:"col-sm-8"},et={class:"mb-3"},at=t("label",{for:"title",class:"form-label"},"標題",-1),ot={class:"row"},st={class:"mb-3 col-md-6"},lt=t("label",{for:"category",class:"form-label"},"作者",-1),it={class:"row"},nt={class:"mb-3 col-md-6"},dt=t("label",{for:"origin_price",class:"form-label"},"標籤",-1),ct={class:"mb-3 col-md-6"},rt={key:0,for:"date",class:"form-label"},mt={key:1,for:"date"},ht=t("hr",null,null,-1),_t={class:"mb-3"},ut=t("label",{for:"description",class:"form-label"},"文章描述",-1),pt={class:"mb-3"},bt=t("label",{for:"content",class:"form-label"},"這是內容",-1),gt={class:"mb-3"},ft={class:"form-check"},vt=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),yt={class:"modal-footer"},Pt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function kt(a,e,p,Mt,s,n){const f=g("Loading"),v=g("Pagination");return i(),d(b,null,[t("div",I,[t("div",S,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=o=>n.openModal())}," 建立新的文章 ")]),t("table",T,[B,t("tbody",null,[(i(!0),d(b,null,L(s.ariticleData.articles,(o,y)=>(i(),d("tr",{key:y},[t("td",null,_(o.title),1),t("td",null,_(n.time(o.create_at)),1),t("td",null,_(o.author),1),t("td",null,[o.isPublic?(i(),d("span",N,"啟用")):(i(),d("span",R,"未啟用"))]),t("td",null,[t("div",z,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:P=>n.openEditModla(o)}," 編輯 ",8,F),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:P=>n.delArticle(o.id)}," 刪除 ",8,O)])])]))),128))])])]),t("div",H,[t("div",W,[t("div",j,[q,t("div",G,[t("div",J,[t("div",K,[t("div",Q,[t("div",X,[Y,l(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[1]||(e[1]=o=>s.data.image=o)},null,512),[[c,s.data.image]])]),Z]),$]),t("div",tt,[t("div",et,[at,l(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[2]||(e[2]=o=>s.data.title=o)},null,512),[[c,s.data.title]])]),t("div",ot,[t("div",st,[lt,l(t("input",{id:"category",type:"text",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=o=>s.data.author=o),placeholder:"請輸入作者"},null,512),[[c,s.data.author]])])]),t("div",it,[t("div",nt,[dt,l(t("input",{id:"origin_price",type:"text",min:"0",class:"form-control",placeholder:"請輸入標籤","onUpdate:modelValue":e[4]||(e[4]=o=>s.data.tag=o)},null,512),[[c,s.data.tag]])]),t("div",ct,[s.date?(i(),d("label",mt,"發布日期:"+_(n.time(s.date)),1)):(i(),d("label",rt,"日期")),l(t("input",{id:"date",type:"date",min:"0",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=o=>s.data.create_at=o),placeholder:"請輸入日期"},null,512),[[c,s.data.create_at]])])]),ht,t("div",_t,[ut,l(t("textarea",{id:"description",type:"text",class:"form-control","onUpdate:modelValue":e[6]||(e[6]=o=>s.data.description=o),placeholder:"請輸入產品 描述"},`\r
                      `,512),[[c,s.data.description]])]),t("div",pt,[bt,l(t("textarea",{id:"description",type:"text",class:"form-control","onUpdate:modelValue":e[7]||(e[7]=o=>s.data.content=o),placeholder:"請輸入說明內容"},`\r
                      `,512),[[c,s.data.content]])]),t("div",gt,[t("div",ft,[l(t("input",{type:"checkbox",class:"form-check-input",id:"is_enabled","onUpdate:modelValue":e[8]||(e[8]=o=>s.data.isPublic=o)},null,512),[[V,s.data.isPublic]]),vt])])])])]),t("div",yt,[Pt,t("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=o=>n.newArticle())}," 確認 ")])])])],512),w(f,{active:s.isLoading,"onUpdate:active":e[10]||(e[10]=o=>s.isLoading=o)},null,8,["active"]),s.pagination.total_pages>=2?(i(),C(v,{key:0,pagination:s.pagination,onChangePage:n.changePage},null,8,["pagination","onChangePage"])):E("",!0)],64)}const Et=A(D,[["render",kt]]);export{Et as default};
