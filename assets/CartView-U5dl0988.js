import{c as P}from"./cart-e-CphGvN.js";import{M as I}from"./bootstrap.esm-TTjMTX3M.js";import{_ as A,R as N,m as E,c as d,b as t,d as c,w as u,F as h,i as p,g as b,t as a,e as k,r as C,o as l}from"./index-Ej9kf163.js";import{S as M}from"./sweetalert2.all-t36qbmOe.js";import{a as m}from"./axios-G2rPRu76.js";import{L as V}from"./index-g4Q1I_Cp.js";var R={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_API_NAME:"ssozr",BASE_URL:"/vue2024week62/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:f,VITE_APP_API_NAME:y}=R,B={data(){return{cartData:[],dalModal:"",delData:{},delId:"",disabled:!1,productData:{},isLoading:!1}},components:{RouterLink:N,Loading:V},methods:{getCartData(){m.get(`${f}/v2/api/${y}/cart`).then(s=>{this.cartData=s.data.data,console.log(this.cartData)}).catch(s=>{alert(s.data.message).error(s)}).finally(()=>{this.isLoading=!1})},openDelModal(s){this.deldata={},this.delModal.show(),this.delId=s.id,this.delData=s.product},openDelAllModal(){this.delData={},this.delId="",this.delData.title="全部商品",this.delModal.show()},delCart(){this.delId?m.delete(`${f}/v2/api/${y}/cart/${this.delId}`).then(s=>{this.delData={},this.delId="",this.delModal.hide(),this.getCartData(),M.fire(`${s.data.message}`),this.getCartDataPinia()}).catch(s=>{alert(s.data.message).error(s)}):m.delete(`${f}/v2/api/${y}/carts`).then(()=>{this.delData={},this.delId=" ",this.delModal.hide(),this.getCartData(),this.getCartDataPinia()}).catch(s=>{alert(s.data.message).error(s)})},changeQty(s,r,D){console.log(r),this.disabled=!0;const w={product_id:D,qty:s};m.put(`${f}/v2/api/${y}/cart/${r}`,{data:w}).then(o=>{M.fire(`${o.data.message}`),this.disabled=!1,this.getCartData()}).catch(o=>{alert(o.data.message).error(o)})},formatNumber(s){if(s)return s.toLocaleString()},...E(P,["getCartDataPinia"])},mounted(){this.isLoading=!0,this.getCartData(),this.delModal=new I(this.$refs.delModal)}},S={class:"container","data-aos":"fade-right"},T={class:"row justify-content-center"},j={key:0,class:"text-center my-30"},q=t("div",{class:"d-flex justify-content-center"},[t("h2",{class:"mb-10 border-bottom border-3 border-primary"}," 尚未收錄課程 ")],-1),O={key:1,class:"table-wrapper d-lg-block d-none"},U={class:"table align-middle"},Q={class:"text-center"},$=t("th",null,"課程名稱",-1),F=t("th",null,"授課老師",-1),z=t("th",null,"總課程數",-1),G=t("th",null,"購買數量",-1),H=t("th",null,"單價",-1),J=t("th",null,"價格",-1),K={class:"fs-5"},W={class:"dropdown"},X=["disabled"],Y={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},Z=["onClick"],tt=["onClick"],et={class:"text-center"},st=t("td",null,null,-1),ot=t("td",null,null,-1),at=t("td",null,null,-1),dt=t("td",null,null,-1),lt={class:"align-bottom"},nt={class:"border-bottom border-primary border-3 mb-0 fs-6"},rt={class:"ms-1"},it=t("button",{type:"button",class:"btn btn-primary"}," 結帳 ",-1),ct={key:2,class:"row d-lg-none my-15"},_t={class:"d-flex justify-content-between align-items-center mb-3"},ut={class:"fs-5"},ht={class:"fs-7"},bt=["onClick"],pt={class:"d-flex align-items-center justify-content-between"},mt={class:"dropdown"},ft=["disabled"],yt={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},gt=["onClick"],vt={class:"d-flex justify-content-between"},Dt={class:"border-bottom border-primary border-3 mb-0 fs-4"},wt={class:"ms-1"},kt=t("button",{type:"button",class:"btn btn-primary"}," 結帳 ",-1),Ct={class:"modal",tabindex:"-1",ref:"delModal"},Mt={class:"modal-dialog"},xt={class:"modal-content"},Lt={class:"modal-header"},Pt={key:0,class:"modal-title"},It=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),At=t("div",{class:"modal-body"},[t("p",null,"確定移出此課程?")],-1),Nt={class:"modal-footer"},Et=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Vt(s,r,D,w,o,n){const x=C("Loading"),_=C("RouterLink");return l(),d(h,null,[t("div",S,[t("div",T,[c(x,{active:o.isLoading,"onUpdate:active":r[0]||(r[0]=e=>o.isLoading=e)},null,8,["active"]),o.cartData.total===0?(l(),d("div",j,[q,c(_,{to:"products",class:"btn btn-primary"},{default:u(()=>[b("立即前往課程列表")]),_:1})])):(l(),d("div",O,[t("table",U,[t("thead",null,[t("tr",Q,[$,F,z,G,H,J,t("th",null,[t("button",{type:"button",class:"btn btn-primary rounded-pill",onClick:r[1]||(r[1]=e=>n.openDelAllModal())}," 清空購物車 ")])])]),t("tbody",null,[(l(!0),d(h,null,p(o.cartData.carts,(e,g)=>(l(),d("tr",{key:g,class:"text-center"},[t("td",null,[c(_,{to:`/class/${e.product.id}`},{default:u(()=>[t("h2",K,a(e.product.title),1)]),_:2},1032,["to"])]),t("td",null,a(e.product.unit),1),t("td",null,a(e.product.origin_price*e.qty)+"堂",1),t("td",null,[t("div",W,[t("button",{disabled:o.disabled,class:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"},a(e.qty),9,X),t("ul",Y,[(l(),d(h,null,p(20,(i,v)=>t("li",{key:v},[t("a",{onClick:L=>n.changeQty(i,e.id,e.product_id),class:"dropdown-item"},a(i),9,Z)])),64))])])]),t("td",null,a(e.product.price),1),t("td",null,a(n.formatNumber(e.total)),1),t("td",null,[t("button",{type:"button",class:"btn btn-primary rounded-pill",onClick:i=>n.openDelModal(e)}," 刪除 ",8,tt)])]))),128)),t("tr",et,[st,ot,at,dt,t("td",lt,[t("h2",nt,[b(" 總金額:NT "),t("span",rt,a(n.formatNumber(o.cartData.total)),1)])]),t("td",null,[c(_,{to:"/Order"},{default:u(()=>[it]),_:1})])])])])])),o.cartData.total!==0?(l(),d("div",ct,[(l(!0),d(h,null,p(o.cartData.carts,(e,g)=>(l(),d("ul",{key:g,class:"border-bottom pb-3 border-primary"},[t("li",null,[t("div",_t,[c(_,{to:`/class/${e.product.id}`},{default:u(()=>[t("h2",ut,[b(a(e.product.title)+" ",1),t("span",ht,"單價:"+a(e.product.price),1)])]),_:2},1032,["to"]),t("button",{type:"button",class:"btn btn-primary rounded-pill",onClick:i=>n.openDelModal(e)}," 刪除 ",8,bt)]),t("div",pt,[t("div",null,"總堂數:"+a(e.product.origin_price*e.qty)+"堂",1),t("div",mt,[b(" 購買次數: "),t("button",{disabled:o.disabled,class:"btn btn-secondary dropdown-toggle py-0",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"},a(e.qty),9,ft),t("ul",yt,[(l(),d(h,null,p(20,(i,v)=>t("li",{key:v},[t("a",{onClick:L=>n.changeQty(i,e.id,e.product_id),class:"dropdown-item"},a(i),9,gt)])),64))])]),t("div",null,"此課程總額: $"+a(n.formatNumber(e.total)),1)])])]))),128)),t("div",vt,[t("h2",Dt,[b(" 總金額:NT "),t("span",wt,a(n.formatNumber(o.cartData.total)),1)]),c(_,{to:"/Order"},{default:u(()=>[kt]),_:1})])])):k("",!0)])]),t("div",Ct,[t("div",Mt,[t("div",xt,[t("div",Lt,[o.delData.title?(l(),d("h5",Pt,a(o.delData.title),1)):k("",!0),It]),At,t("div",Nt,[Et,t("button",{type:"button",class:"btn btn-primary",onClick:r[2]||(r[2]=e=>n.delCart(o.delData.id))}," 確認移出 ")])])])],512)],64)}const Ot=A(B,[["render",Vt]]);export{Ot as default};
