import{a as _}from"./axios-G2rPRu76.js";import{L as k}from"./index-iKm6SRjS.js";import{S as g}from"./sweetalert2.all-t36qbmOe.js";import{M as b}from"./bootstrap.esm-TTjMTX3M.js";import{P as D}from"./PaginationView-1knMy8gy.js";import{_ as C,c as d,b as e,F as u,i as h,d as f,t as a,e as I,r as v,o as n}from"./index-P1H6muw5.js";var L={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_API_NAME:"ssozr",BASE_URL:"/vue2024week62/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:m,VITE_APP_API_NAME:p}=L,O={data(){return{show:!1,isLoading:!1,orders:[],delModal:"",delModalId:"",orderModal:"",orderModalId:"",orderData:"",pagination:{},page:""}},components:{Loading:k,Pagination:D},methods:{getOrders(s=1){_.get(`${m}/v2/api/${p}/admin/orders/?page=${s}`).then(t=>{this.isLoading=!1,this.orders=t.data.orders,this.pagination=t.data.pagination,console.log(t)}).catch(t=>{alert(t.data.message).error(t)})},opDelModal(s){this.delModalId=s,this.delModal.show()},deleteOrder(){const s=this.delModalId;_.delete(`${m}/v2/api/${p}/admin/order/${s}`).then(t=>{g.fire(`${t.data.message}`),this.getOrders(),this.delModal.hide()}).catch(t=>{alert(t.data.message).error(t)})},opOrderModal(s){this.orderModal.show(),this.orderData={...s}},upDataPaid(s){const t={is_paid:!s.is_paid};_.put(`${m}/v2/api/${p}/admin/order/${s.id}`,{data:t}).then(i=>{g.fire(`${i.data.message}`),this.getOrders()}).catch(i=>{alert(i.data.message).error(i)})},changePage(s){this.getOrders(s)},time(s){const t=new Date(s*1e3),i={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"};return t.toLocaleString("zh-TW",i)}},mounted(){this.isLoading=!0,this.getOrders(),this.delModal=new b(this.$refs.delModal),this.orderModal=new b(this.$refs.orderModal)}},A={class:"table"},E=e("thead",null,[e("tr",null,[e("th",null,"購買時間"),e("th",null,"Email"),e("th",null,"購買款項"),e("th",null,"應付金額"),e("th",null,"是否付款"),e("th",null,"編輯")])],-1),w={class:"list-unstyled"},x={class:"form-check form-switch"},V=["checked","onClick"],S=["for"],N={key:0},R={key:1},T=["onClick"],U=["onClick"],B={class:"modal",tabindex:"-1",id:"delModal",ref:"delModal"},$={class:"modal-dialog"},q={class:"modal-content"},z=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"確認刪除?"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),F={class:"modal-body"},W={class:"modal-footer"},j=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1),G={class:"modal",tabindex:"-1",id:"orderModal",ref:"orderModal"},H={class:"modal-dialog"},J={class:"modal-content"},K={class:"modal-header"},Q={class:"modal-title"},X=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Y={class:"modal-body"},Z={key:0};function ee(s,t,i,te,l,r){const M=v("Pagination"),y=v("loading");return n(),d(u,null,[e("table",A,[E,e("tbody",null,[(n(!0),d(u,null,h(l.orders,o=>(n(),d("tr",{key:o.id},[e("td",null,a(r.time(o.create_at)),1),e("td",null,a(o.user.email),1),e("td",null,[e("ul",w,[(n(!0),d(u,null,h(o.products,(c,P)=>(n(),d("li",{key:P},a(c.product.title)+"*"+a(c.qty)+"="+a(c.total),1))),128))])]),e("td",null,a(o.total),1),e("td",null,[e("div",x,[e("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"item.id",checked:o.is_paid,onClick:c=>r.upDataPaid(o)},null,8,V),e("label",{class:"form-check-label",for:o.id},[o.is_paid?(n(),d("p",N,"已付款")):(n(),d("p",R,"未付款"))],8,S)])]),e("td",null,[e("button",{type:"button",class:"btn btn-outline-primary",onClick:c=>r.opOrderModal(o)},"檢視",8,T),e("button",{type:"button",class:"btn btn-outline-primary",onClick:c=>r.opDelModal(o.id)},"刪除",8,U)])]))),128))])]),f(M,{pagination:l.pagination,onChangePage:r.changePage},null,8,["pagination","onChangePage"]),f(y,{active:l.isLoading,"onUpdate:active":t[0]||(t[0]=o=>l.isLoading=o)},null,8,["active"]),e("div",B,[e("div",$,[e("div",q,[z,e("div",F,[e("p",null,"訂單編號:"+a(l.delModalId),1)]),e("div",W,[j,e("button",{type:"button",onClick:t[1]||(t[1]=o=>r.deleteOrder()),class:"btn btn-primary"},"確定刪除")])])])],512),e("div",G,[e("div",H,[e("div",J,[e("div",K,[e("h5",Q,"訂單編號"+a(l.orderData.id),1),X]),e("div",Y,[e("ul",null,[(n(!0),d(u,null,h(l.orderData.products,o=>(n(),d("li",{key:o.id},a(o.product.title)+" 數量:"+a(o.qty),1))),128))]),l.orderData?(n(),d("ul",Z,[e("li",null,"訂單人姓名"+a(l.orderData.user.name),1),e("li",null,"信箱"+a(l.orderData.user.email),1),e("li",null,"電話"+a(l.orderData.user.tel),1),e("li",null,"備註"+a(l.orderData.user.address),1)])):I("",!0)])])])],512)],64)}const ie=C(O,[["render",ee]]);export{ie as default};
